%h1 Email Sender

%form{action: "/send", method: "post"}
  %table
    %tr
      %td
        %label{for: "from_name"}Name
      %td
        %input#from_name{type: "text", name: "your_name", placeHolder: "Your name"}
    %tr
      %td
        %label{for: "from_mail"}Your E-Mail
      %td
        %input#from_mail{type: "text", name: "your_email", placeHolder: "Your e-mail"}
    %tr
      %td
        %label{for: "to_mail"}Their E-Mail
      %td
        %input#to_mail{type: "text", name: "to", placeHolder: "Their e-mail"}
    %tr
      %td
        %label{for: "subject"}Subject
      %td
        %input#subject{type: "text", name: "subject", placeHolder: "Subject"}
    %tr
      %td
        %label{for: "body"}Content
      %td
        %textarea#body{name: "body", placeHolder: "Content"}
    %tr
      %td
      %td
        %button{type: "submit"}Send


:coffee
  jQuery -> 
    $("form").on("submit",
      (event) ->
        event.preventDefault()

        from_name = $("#from_name").val()
        from_mail = $("#from_mail").val()
        to = $("#to_mail").val()
        subject = $("#subject").val()
        body = $("#body").val()

        options =
          url: "/send"
          method: "post"
          data:
            from: from_name + " <" + from_mail + ">"
            to: to
            subject: subject
            body: body
          dataType: "json"
          complete: (response, status) ->
            results = response.responseJSON
            if results.success
              alert "Success"
            else
              alert "Failure"
        $.ajax options
      )
